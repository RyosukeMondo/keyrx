import{j as e,r as t,s}from"./vendor-DchKSmaM.js";import{a,K as i}from"./useProfileConfig-B4iSMHmG.js";import{_ as l,B as n,__tla as __tla_0}from"./index-DNY7ggn3.js";import{C as r}from"./client-DsuQMGGi.js";import{u as o}from"./useProfiles-MkTJ18U7.js";import{g as c}from"./errorUtils-C0i9WI_e.js";import"./Tooltip-Eiv0HiOq.js";import"./schemas-DRbUxdzV.js";let x,p;let __tla=Promise.all([(()=>{try{return __tla_0}catch{}})()]).then(async()=>{function d({state:t}){return t?e.jsx("div",{className:"p-4 bg-slate-800 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-slate-300 mb-2","aria-label":"Active Modifiers",children:"Modifiers"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.modifiers&&t.modifiers.length>0?t.modifiers.map(t=>e.jsxs("span",{className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-full font-medium","aria-label":`Modifier ${t} active`,children:["MOD_",t]},`mod-${t}`)):e.jsx("span",{className:"text-slate-500 text-sm","aria-label":"No modifiers active",children:"None"})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-slate-300 mb-2","aria-label":"Active Locks",children:"Locks"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.locks&&t.locks.length>0?t.locks.map(t=>e.jsxs("span",{className:"px-3 py-1 bg-orange-600 text-white text-sm rounded-full font-medium","aria-label":`Lock ${t} active`,children:["LOCK_",t]},`lock-${t}`)):e.jsx("span",{className:"text-slate-500 text-sm","aria-label":"No locks active",children:"None"})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-slate-300 mb-2","aria-label":"Current Layer",children:"Layer"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:e.jsxs("span",{className:"px-3 py-1 bg-green-600 text-white text-sm rounded-full font-medium","aria-label":`Layer ${t.layer} active`,children:["Layer ",t.layer]})})]})]})}):e.jsx("div",{className:"p-4 bg-slate-800 rounded-lg",children:e.jsx("p",{className:"text-slate-400 text-sm",children:"Loading daemon state..."})})}const m=t.createContext(null);function u({children:s}){const[a,i]=t.useState(!1),[n,r]=t.useState(!0),[o,c]=t.useState(null),[d,u]=t.useState(null);t.useEffect(()=>{!async function(){performance.now(),r(!0);try{const e=await l(()=>import("./keyrx_core-BqPpThVb.js"),[]).catch(()=>{throw new Error("WASM module not found. Run build:wasm to compile the WASM module.")});e.wasm_init(),performance.now(),u(e),i(!0),r(!1)}catch(e){const t=e instanceof Error?e.message:String(e);performance.now(),c(e instanceof Error?e:new Error(t)),i(!1),r(!1)}}()},[]);const f=t.useCallback(async e=>{if(!a||!d)return[];try{return d.load_config(e),[]}catch(t){const e=t instanceof Error?t.message:String(t),s=e.match(/line (\d+)/i),a=e.match(/column (\d+)/i);return[{line:s?parseInt(s[1],10):1,column:a?parseInt(a[1],10):1,length:1,message:e}]}},[a,d]),x=t.useCallback(async(e,t)=>{if(!a||!d)return null;try{const s=d.load_config(e),a=JSON.stringify(t);return d.simulate(s,a)}catch(s){return s instanceof Error?s.message:String(s),null}},[a,d]),p={isWasmReady:a,isLoading:n,error:o,validateConfig:f,runSimulation:x};return e.jsx(m.Provider,{value:p,children:s})}function f({value:a,onChange:i,onValidate:l,readOnly:n=!1,height:r="600px"}){const o=t.useRef(null),c=t.useRef(null),d=t.useRef(null),[u,f]=t.useState(0),[x,p]=t.useState([]),[h,g]=t.useState("Initializing..."),{isWasmReady:y,isLoading:v,validateConfig:b}=function(){const e=t.useContext(m);if(!e)throw new Error("useWasmContext must be used within WasmProvider");return e}();t.useEffect(()=>{g(v?"⏳ Loading WASM validator...":y?"✓ Ready":"⚠ WASM unavailable")},[v,y]);const j=t.useCallback(()=>{if(!o.current||!c.current||0===x.length)return;const e=(u+1)%x.length;f(e);const t=x[e],s={lineNumber:t.line,column:t.column};o.current.setPosition(s),o.current.revealPositionInCenter(s),o.current.focus()},[x,u]),k=t.useCallback(async e=>{if(y){g("Validating...");try{const t=await b(e);if(p(t),f(0),0===t.length?g("✓ No errors"):g(`✗ ${t.length} error${t.length>1?"s":""}`),l&&l(t),o.current&&c.current){const e=o.current.getModel();if(e){const s=t.map(e=>({severity:c.current.MarkerSeverity.Error,startLineNumber:e.line,startColumn:e.column,endLineNumber:e.line,endColumn:e.column+e.length,message:e.message}));c.current.editor.setModelMarkers(e,"rhai",s)}}}catch(t){g("Validation failed")}}else g("WASM validation unavailable")},[y,b,l]),w=t.useCallback(e=>{void 0!==e&&(i&&i(e),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{k(e)},500))},[i,k]);return t.useEffect(()=>{a&&y&&k(a)},[a,y,k]),t.useEffect(()=>()=>{d.current&&clearTimeout(d.current)},[]),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between px-2 py-1 bg-slate-800 rounded text-sm",children:[e.jsx("span",{className:"text-slate-400",children:"Rhai Configuration Editor"}),e.jsx("span",{className:"font-mono "+(h.startsWith("✓")?"text-green-400":h.startsWith("✗")?"text-red-400":"text-slate-400"),children:h})]}),e.jsx(s,{height:r,defaultLanguage:"rhai",theme:"rhai-dark",value:a,onChange:w,beforeMount:e=>{c.current=e,e.languages.register({id:"rhai"}),e.languages.setMonarchTokensProvider("rhai",{keywords:["let","const","if","else","while","for","loop","break","continue","return","fn","true","false","import","export","as","private","this","in"],operators:["=",">","<","!","~","?",":","==","<=",">=","!=","&&","||","++","--","+","-","*","/","&","|","^","%","<<",">>",">>>","+=","-=","*=","/=","&=","|=","^=","%=","<<=",">>=",">>>=","=>"],symbols:/[=><!~?:&|+\-*/^%]+/,escapes:/\\(?:[abfnrtv\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,tokenizer:{root:[[/[a-zA-Z_]\w*/,{cases:{"@keywords":"keyword","@default":"identifier"}}],{include:"@whitespace"},[/[{}()[\]]/,"@brackets"],[/[<>](?!@symbols)/,"@brackets"],[/@symbols/,{cases:{"@operators":"operator","@default":""}}],[/\d*\.\d+([eE][-+]?\d+)?/,"number.float"],[/0[xX][0-9a-fA-F]+/,"number.hex"],[/\d+/,"number"],[/"([^"\\]|\\.)*$/,"string.invalid"],[/"/,"string","@string_double"],[/'([^'\\]|\\.)*$/,"string.invalid"],[/'/,"string","@string_single"]],whitespace:[[/[ \t\r\n]+/,""],[/\/\*/,"comment","@comment"],[/\/\/.*$/,"comment"]],comment:[[/[^/*]+/,"comment"],[/\*\//,"comment","@pop"],[/[/*]/,"comment"]],string_double:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],string_single:[[/[^\\']+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/'/,"string","@pop"]]}}),e.editor.defineTheme("rhai-dark",{base:"vs-dark",inherit:!0,rules:[{token:"keyword",foreground:"C586C0",fontStyle:"bold"},{token:"identifier",foreground:"9CDCFE"},{token:"operator",foreground:"D4D4D4"},{token:"number",foreground:"B5CEA8"},{token:"number.float",foreground:"B5CEA8"},{token:"number.hex",foreground:"B5CEA8"},{token:"string",foreground:"CE9178"},{token:"comment",foreground:"6A9955",fontStyle:"italic"}],colors:{"editor.background":"#1e1e1e","editor.foreground":"#d4d4d4","editorLineNumber.foreground":"#858585","editor.selectionBackground":"#264f78","editor.inactiveSelectionBackground":"#3a3d41"}})},onMount:(e,t)=>{o.current=e,c.current=t,e.updateOptions({minimap:{enabled:!1},fontSize:14,tabSize:2,rulers:[80,120],automaticLayout:!0,scrollBeyondLastLine:!1,wordWrap:"on"}),e.addCommand(t.KeyCode.F8,()=>{j()})},options:{readOnly:n}}),x.length>0&&e.jsx("div",{className:"px-2 py-1 bg-slate-800 rounded text-xs text-slate-400",children:"Press F8 to navigate to next error"})]})}x=()=>{const[s,m]=t.useState(new Set),[u,x]=t.useState([]),[p,h]=t.useState({activeLayer:"MD_00 (Base)",modifiers:{ctrl:!1,shift:!1,alt:!1,gui:!1},locks:{capsLock:!1,numLock:!1,scrollLock:!1}}),[g,y]=t.useState(!1),[v,b]=t.useState(new Map),j=t.useRef(),k=t.useRef(Date.now()),[w,N]=t.useState(""),{data:_,isLoading:S}=o(),{data:C,isLoading:L}=a(w),{isWasmReady:A,isLoading:E,validateConfig:M,runSimulation:$}=function(){const[e,s]=t.useState(!1),[a,i]=t.useState(!0),[n,r]=t.useState(null),[o,c]=t.useState(null);t.useEffect(()=>{!async function(){performance.now(),i(!0);try{const e=await l(()=>import("./keyrx_core-BqPpThVb.js"),[]).catch(()=>{throw new Error("WASM module not found. Run build:wasm to compile the WASM module.")});e.wasm_init(),performance.now(),c(e),s(!0),i(!1)}catch(e){const t=e instanceof Error?e.message:String(e);performance.now(),r(e instanceof Error?e:new Error(t)),s(!1),i(!1)}}()},[]);const d=t.useCallback(async t=>{if(!e||!o)return[];try{return o.load_config(t),[]}catch(s){const e=s instanceof Error?s.message:String(s),t=e.match(/line (\d+)/i),a=e.match(/column (\d+)/i);return[{line:t?parseInt(t[1],10):1,column:a?parseInt(a[1],10):1,length:1,message:e}]}},[e,o]),m=t.useCallback(async(t,s)=>{if(!e||!o)return null;try{const e=o.load_config(t),a=JSON.stringify(s);return o.simulate(e,a)}catch(a){return a instanceof Error?a.message:String(a),null}},[e,o]);return{isWasmReady:e,isLoading:a,error:n,validateConfig:d,runSimulation:m}}(),[W,D]=t.useState(null),[R,T]=t.useState(!1),[O,P]=t.useState(null),[B,I]=t.useState(!1),[F,z]=t.useState("// Write your Rhai configuration here\n"),[K,U]=t.useState([]);t.useEffect(()=>{_&&_.length>0&&!w&&N(_[0].name)},[_,w]),t.useEffect(()=>{!async function(){if(!C||!A)return T(!1),void D(null);try{const e=await M(C.source);if(e.length>0){const t=e.map(e=>`Line ${e.line}: ${e.message}`).join("; ");D(t),T(!1)}else D(null),T(!0)}catch(e){const t=c(e,"Failed to load profile config");D(t),T(!1)}}()},[C,A,M]);const V=new Map([["CAPS",{type:"tap_hold",tapAction:"Escape",holdAction:"Ctrl",threshold:200}],["SPACE",{type:"tap_hold",tapAction:"Space",holdAction:"Layer_1",threshold:150}]]),H=t.useCallback(e=>{const t=(new Date).toLocaleTimeString("en-US",{hour12:!1});x(s=>[{...e,timestamp:t},...s].slice(0,1e3))},[]),J=t.useCallback(async e=>{if(!g)if(k.current=Date.now(),m(t=>new Set(t).add(e)),H({type:"press",key:e,message:`Press ${e}`}),R&&C&&A&&$)try{const t={events:[{keycode:e,event_type:"press",timestamp_us:1e3*Date.now()}]},s=await $(C.source,t);s&&(P({modifiers:s.final_state.active_modifiers.map(e=>`MD_${e.toString().padStart(2,"0")}`),locks:s.final_state.active_locks.map(e=>`LK_${e.toString().padStart(2,"0")}`),layer:s.final_state.active_layer||"Base"}),s.outputs.forEach(e=>{H({type:"output",key:e.keycode,message:`Output ${e.keycode} (${e.event_type})`})}),h({activeLayer:s.final_state.active_layer||"MD_00 (Base)",modifiers:{ctrl:s.final_state.active_modifiers.includes(0),shift:s.final_state.active_modifiers.includes(1),alt:s.final_state.active_modifiers.includes(2),gui:s.final_state.active_modifiers.includes(3)},locks:{capsLock:s.final_state.active_locks.includes(0),numLock:s.final_state.active_locks.includes(1),scrollLock:s.final_state.active_locks.includes(2)}}))}catch(t){H({type:"output",message:`WASM Error: ${c(t,"Simulation failed")}`})}else{const t=V.get(e);if("tap_hold"===t?.type&&t.threshold){const s=window.setTimeout(()=>{H({type:"wait",key:e,message:`→Wait ${t.threshold}ms (hold)`}),H({type:"output",key:e,message:`Output ${t.holdAction} (hold)`}),"Ctrl"===t.holdAction&&h(e=>({...e,modifiers:{...e.modifiers,ctrl:!0}}))},t.threshold);b(t=>new Map(t).set(e,s))}else H({type:"output",key:e,message:`Output ${t?.tapAction||e}`})}},[g,V,H,R,C,A,$]),Z=t.useCallback(async e=>{if(!g)if(k.current=Date.now(),m(t=>{const s=new Set(t);return s.delete(e),s}),H({type:"release",key:e,message:`Release ${e}`}),R&&C&&A&&$)try{const t={events:[{keycode:e,event_type:"release",timestamp_us:1e3*Date.now()}]},s=await $(C.source,t);s&&(P({modifiers:s.final_state.active_modifiers.map(e=>`MD_${e.toString().padStart(2,"0")}`),locks:s.final_state.active_locks.map(e=>`LK_${e.toString().padStart(2,"0")}`),layer:s.final_state.active_layer||"Base"}),s.outputs.forEach(e=>{H({type:"output",key:e.keycode,message:`Output ${e.keycode} (${e.event_type})`})}),h({activeLayer:s.final_state.active_layer||"MD_00 (Base)",modifiers:{ctrl:s.final_state.active_modifiers.includes(0),shift:s.final_state.active_modifiers.includes(1),alt:s.final_state.active_modifiers.includes(2),gui:s.final_state.active_modifiers.includes(3)},locks:{capsLock:s.final_state.active_locks.includes(0),numLock:s.final_state.active_locks.includes(1),scrollLock:s.final_state.active_locks.includes(2)}}))}catch(t){H({type:"output",message:`WASM Error: ${c(t,"Simulation failed")}`})}else{const t=v.get(e);if(void 0!==t){clearTimeout(t),b(t=>{const s=new Map(t);return s.delete(e),s});const s=V.get(e);"tap_hold"===s?.type&&H({type:"output",key:e,message:`Output ${s.tapAction} (tap)`})}const s=V.get(e);"tap_hold"===s?.type&&"Ctrl"===s.holdAction&&h(e=>({...e,modifiers:{...e.modifiers,ctrl:!1}}))}},[g,v,V,H,R,C,A,$]),X=t.useCallback(e=>{s.has(e)?Z(e):J(e)},[s,J,Z]),q=t.useCallback(()=>{m(new Set),x([]),h({activeLayer:"MD_00 (Base)",modifiers:{ctrl:!1,shift:!1,alt:!1,gui:!1},locks:{capsLock:!1,numLock:!1,scrollLock:!1}}),P(null),y(!1),v.forEach(e=>clearTimeout(e)),b(new Map),k.current=Date.now(),H({type:"output",message:"Simulator reset"})},[v,H]),G=t.useCallback(()=>{const e=u.map(e=>`${e.timestamp}  ${e.type.padEnd(8)}  ${e.message}`).join("\n");navigator.clipboard.writeText(e)},[u]);return t.useEffect(()=>(j.current=setInterval(()=>{Date.now()-k.current>6e4&&!g&&(y(!0),H({type:"output",message:"Auto-paused after 60 seconds of inactivity"}))},1e3),()=>{j.current&&clearInterval(j.current)}),[g,H]),t.useEffect(()=>()=>{v.forEach(e=>clearTimeout(e))},[v]),e.jsxs("div",{className:"flex flex-col gap-4 md:gap-6 p-4 md:p-6 lg:p-8",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl lg:text-3xl font-bold text-slate-100",children:"Keyboard Simulator"}),e.jsx("p",{className:"text-sm md:text-base text-slate-400 mt-2",children:"Test your configuration by clicking keys or typing. Changes are not saved to your keyboard."})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(n,{variant:"secondary",size:"md",onClick:G,"aria-label":"Copy event log to clipboard",disabled:0===u.length,className:"w-full sm:w-auto min-h-[44px] sm:min-h-0",children:"Copy Event Log"}),e.jsx(n,{variant:"danger",size:"md",onClick:q,"aria-label":"Reset simulator state",className:"w-full sm:w-auto min-h-[44px] sm:min-h-0",children:"Reset Simulator"})]})]}),e.jsx(r,{"aria-label":"Configuration mode selector",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-sm font-medium text-slate-300",children:"Configuration Mode:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>I(!1),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors "+(B?"bg-slate-700 text-slate-300 hover:bg-slate-600":"bg-primary-500 text-white"),children:"Use Profile"}),e.jsx("button",{onClick:()=>I(!0),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors "+(B?"bg-primary-500 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"),children:"Edit Code (WASM)"})]})]}),B?e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Edit Rhai configuration and test with WASM compilation + simulation"}),K.length>0&&e.jsxs("span",{className:"text-xs text-red-400",children:[K.length," error",K.length>1?"s":""]})]}),e.jsx("div",{className:"h-[400px]",children:e.jsx(f,{value:F,onChange:e=>z(e),onValidate:U,height:"400px"})})]}):e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3",children:[e.jsx("label",{htmlFor:"profile-selector",className:"text-sm font-medium text-slate-300 shrink-0",children:"Select Profile:"}),e.jsx("div",{className:"flex-1",children:e.jsx("select",{id:"profile-selector",value:w,onChange:e=>N(e.target.value),disabled:S||!_||0===_.length,className:"w-full sm:w-auto min-w-[200px] px-3 py-2 bg-slate-700 border border-slate-600 rounded-md text-slate-100 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Select profile for simulation",children:S?e.jsx("option",{children:"Loading profiles..."}):_&&_.length>0?_.map(t=>e.jsxs("option",{value:t.name,children:[t.name,t.isActive?" [Active]":""]},t.name)):e.jsx("option",{children:"No profiles available"})})}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[L&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading config..."]}),!L&&R&&e.jsx("span",{className:"text-green-400 font-medium",children:"✓ WASM Simulator Active"}),!L&&C&&!R&&!W&&e.jsx("span",{className:"text-yellow-400",children:"⚠ Using mock simulation (WASM not ready)"}),!A&&!E&&e.jsx("span",{className:"text-yellow-400",children:"⚠ WASM not available (run build:wasm)"})]})]})]})}),W&&e.jsxs("div",{className:"bg-red-500/10 border border-red-500 text-red-400 px-4 py-3 rounded-md",role:"alert",children:[e.jsx("p",{className:"font-medium",children:"Configuration Error"}),e.jsxs("p",{className:"text-sm mt-1",children:["Failed to load profile configuration: ",W]}),e.jsx("p",{className:"text-xs mt-2 text-red-300",children:"The simulator is using mock key mappings. Fix the configuration to use real profile logic."})]}),g&&e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500 text-yellow-500 px-4 py-3 rounded-md",role:"alert",children:[e.jsx("p",{className:"font-medium",children:"Simulator Paused"}),e.jsx("p",{className:"text-sm mt-1",children:"The simulator has been paused after 60 seconds of inactivity. Click any key to resume."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 md:gap-6",children:[e.jsxs(r,{className:"lg:col-span-1","aria-labelledby":"simulator-state-heading",children:[e.jsx("h2",{id:"simulator-state-heading",className:"text-base md:text-lg font-semibold text-slate-100 mb-3",children:"State Inspector"}),R&&O?e.jsx(d,{state:O}):e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsx("div",{children:e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"Active Layer:"}),e.jsx("span",{className:"text-sm font-mono text-slate-100",children:p.activeLayer})]})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-slate-300 mb-2",children:"Modifiers"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(p.modifiers).map(([t,s])=>e.jsxs("div",{className:"px-3 py-2 rounded text-xs font-mono text-center transition-colors "+(s?"bg-green-500 text-white":"bg-slate-700 text-slate-400"),children:[t.charAt(0).toUpperCase()+t.slice(1)," ",s?"✓":""]},t))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-slate-300 mb-2",children:"Locks"}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:Object.entries(p.locks).map(([t,s])=>e.jsxs("div",{className:"px-3 py-2 rounded text-xs font-mono text-center transition-colors "+(s?"bg-blue-500 text-white":"bg-slate-700 text-slate-400"),children:[t.replace(/([A-Z])/g," $1").trim().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")," ",s?"✓":""]},t))})]}),!R&&e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Using mock state. Select a valid profile to see WASM state."})]})]}),e.jsxs(r,{className:"lg:col-span-2","aria-labelledby":"simulator-event-log-heading",children:[e.jsxs("h2",{id:"simulator-event-log-heading",className:"text-base md:text-lg font-semibold text-slate-100 mb-3",children:["Event Log",e.jsxs("span",{className:"text-xs md:text-sm font-normal text-slate-400 ml-2",children:["(last ",Math.min(u.length,1e3)," events)"]})]}),e.jsx("div",{className:"bg-slate-900 rounded-md p-3 md:p-4 h-48 md:h-64 overflow-y-auto font-mono text-xs",children:0===u.length?e.jsx("div",{className:"flex items-center justify-center h-full text-slate-500",children:"No events yet. Click a key to start."}):e.jsx("div",{className:"space-y-1",children:u.map((t,s)=>e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-slate-500 shrink-0",children:t.timestamp}),e.jsx("span",{className:"shrink-0 "+("press"===t.type?"text-green-400":"release"===t.type?"text-red-400":"wait"===t.type?"text-yellow-400":"text-blue-400"),children:t.type.toUpperCase().padEnd(8)}),e.jsx("span",{className:"text-slate-300",children:t.message})]},`${t.timestamp}-${s}`))})})]})]}),e.jsxs(r,{"aria-labelledby":"interactive-keyboard-heading",children:[e.jsx("h2",{id:"interactive-keyboard-heading",className:"text-base md:text-lg font-semibold text-slate-100 mb-4",children:"Interactive Keyboard"}),e.jsx("div",{className:"flex justify-center overflow-x-auto md:overflow-x-visible",children:e.jsx(i,{layout:"ANSI_104",keyMappings:V,onKeyClick:X,simulatorMode:!0,pressedKeys:s})}),e.jsx("p",{className:"text-xs text-slate-500 mt-4 text-center",children:"Click keys to simulate press/release. Hold-configured keys will show timer behavior."})]})]})};p=()=>e.jsx(u,{children:e.jsx(x,{})})});export{x as SimulatorPage,p as default,__tla};