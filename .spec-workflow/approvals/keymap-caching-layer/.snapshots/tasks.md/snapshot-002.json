{
  "id": "snapshot_1764773457179_9f0ry3hc4",
  "approvalId": "approval_1764772900933_jkcfosmcu",
  "approvalTitle": "Tasks: Keymap Caching Layer",
  "version": 2,
  "timestamp": "2025-12-03T14:50:57.179Z",
  "trigger": "approved",
  "status": "pending",
  "content": "# Tasks Document\n\n## Phase 1: Core Cache\n\n- [ ] 1. Create KeymapCache trait\n  - File: `core/src/drivers/common/cache.rs`\n  - Define cache interface with get/insert/invalidate\n  - Add CacheStats type\n  - Purpose: Platform-agnostic cache interface\n  - _Requirements: 1.1, 1.2_\n\n- [ ] 2. Implement LruKeymapCache\n  - File: `core/src/drivers/common/cache.rs`\n  - Use lru crate for LRU eviction\n  - Thread-safe with Mutex\n  - Purpose: Generic LRU cache implementation\n  - _Requirements: 1.1, 1.3, 1.4_\n\n## Phase 2: Platform Integration\n\n- [ ] 3. Add cache to Linux keymap\n  - File: `core/src/drivers/linux/keymap.rs`\n  - Cache evdev scan code lookups\n  - Invalidate on device changes\n  - Purpose: Linux keymap caching\n  - _Requirements: 3.1_\n\n- [ ] 4. Add cache to Windows keymap\n  - File: `core/src/drivers/windows/keymap.rs`\n  - Cache scan-to-vk conversions\n  - Memoize MapVirtualKey calls\n  - Purpose: Windows keymap caching\n  - _Requirements: 3.2_\n\n## Phase 3: Validation\n\n- [ ] 5. Add cache benchmarks and metrics\n  - File: `core/benches/keymap_cache_bench.rs`\n  - Measure hit rate under load\n  - Verify latency improvement\n  - Purpose: Performance validation\n  - _Requirements: 1.4, Non-functional (performance)_\n",
  "fileStats": {
    "size": 1214,
    "lines": 43,
    "lastModified": "2025-12-03T14:39:43.250Z"
  },
  "comments": []
}