{
  "id": "snapshot_1764768818229_zn15f5azj",
  "approvalId": "approval_1764768818204_ya3t460lt",
  "approvalTitle": "Widget Decomposition Tasks (16 tasks)",
  "version": 1,
  "timestamp": "2025-12-03T13:33:38.229Z",
  "trigger": "initial",
  "status": "pending",
  "content": "# Tasks Document\n\n## Phase 1: Directory Structure\n\n- [ ] 1. Create widget directory hierarchy\n  - Files: `ui/lib/widgets/{common,editor,preview,settings}/`\n  - Create directories for each feature area\n  - Add barrel export files\n  - Purpose: Foundation for widget organization\n  - _Leverage: Flutter project structure patterns_\n  - _Requirements: 2.1, 2.3_\n  - _Prompt: Implement the task for spec widget-decomposition, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Flutter Developer setting up structure | Task: Create widget directory hierarchy with barrel exports | Restrictions: Follow Flutter conventions, add index files | _Leverage: Flutter project patterns | Success: Directory structure ready, exports work | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n- [ ] 2. Analyze editor_widgets.dart for extraction\n  - File: `ui/lib/pages/editor_widgets.dart`\n  - Document all widgets and their dependencies\n  - Create extraction plan\n  - Purpose: Plan decomposition\n  - _Leverage: Code analysis_\n  - _Requirements: 1.1_\n  - _Prompt: Implement the task for spec widget-decomposition, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Flutter Developer analyzing code | Task: Analyze editor_widgets.dart and document widgets | Restrictions: List all widgets, dependencies, line counts | _Leverage: Code analysis | Success: Complete widget inventory documented | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n## Phase 2: Common Widget Extraction\n\n- [ ] 3. Extract IconButton variants\n  - File: `ui/lib/widgets/common/styled_icon_button.dart`\n  - Extract custom icon button implementations\n  - Add hover and press states\n  - Purpose: Reusable icon buttons\n  - _Leverage: Existing icon button code_\n  - _Requirements: 1.1, 2.3_\n  - _Prompt: Implement the task for spec widget-decomposition, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Flutter Developer extracting widgets | Task: Extract IconButton variants to common/styled_icon_button.dart | Restrictions: Support all existing use cases, add documentation | _Leverage: Existing implementations | Success: IconButton works in all contexts | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n- [ ] 4. Extract TextField variants\n  - File: `ui/lib/widgets/common/styled_text_field.dart`\n  - Extract custom text field implementations\n  - Unify styling and validation\n  - Purpose: Reusable text inputs\n  - _Leverage: Existing text field code_\n  - _Requirements: 1.1, 2.3_\n  - _Prompt: Implement the task for spec widget-decomposition, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Flutter Developer extracting widgets | Task: Extract TextField variants to common/styled_text_field.dart | Restrictions: Preserve validation, unify styling | _Leverage: Existing implementations | Success: TextField works everywhere | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n- [ ] 5. Extract Dialog widgets\n  - File: `ui/lib/widgets/common/dialogs/`\n  - Extract confirmation, input, and selection dialogs\n  - Create dialog builder helpers\n  - Purpose: Reusable dialogs\n  - _Leverage: Existing dialog code_\n  - _Requirements: 1.1, 2.3_\n  - _Prompt: Implement the task for spec widget-decomposition, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Flutter Developer extracting widgets | Task: Extract Dialog widgets to common/dialogs/ | Restrictions: Preserve behavior, add builders | _Leverage: Existing implementations | Success: Dialogs reusable across app | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n## Phase 3: Editor Widget Extraction\n\n- [ ] 6. Extract KeyButton widget\n  - File: `ui/lib/widgets/editor/key_button.dart`\n  - Extract key button with all states\n  - Add size variants\n  - Purpose: Core key rendering\n  - _Leverage: Existing key rendering_\n  - _Requirements: 1.1, 1.4_\n  - _Prompt: Implement the task for spec widget-decomposition, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Flutter Developer extracting widgets | Task: Extract KeyButton to editor/key_button.dart | Restrictions: Support all states, sizes, interactions | _Leverage: Existing key button | Success: KeyButton works in grid | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n- [ ] 7. Extract KeyGrid widget\n  - File: `ui/lib/widgets/editor/key_grid.dart`\n  - Extract keyboard grid layout\n  - Use KeyButton for individual keys\n  - Purpose: Keyboard visualization\n  - _Leverage: Existing grid layout_\n  - _Requirements: 1.1, 3.2_\n  - _Prompt: Implement the task for spec widget-decomposition, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Flutter Developer extracting widgets | Task: Extract KeyGrid to editor/key_grid.dart | Restrictions: Use KeyButton, efficient rebuilds | _Leverage: Existing grid | Success: KeyGrid renders keyboard correctly | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n- [ ] 8. Extract KeyLegend widget\n  - File: `ui/lib/widgets/editor/key_legend.dart`\n  - Extract legend display\n  - Support horizontal and vertical layouts\n  - Purpose: Key color legend\n  - _Leverage: Existing legend code_\n  - _Requirements: 1.1_\n  - _Prompt: Implement the task for spec widget-decomposition, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Flutter Developer extracting widgets | Task: Extract KeyLegend to editor/key_legend.dart | Restrictions: Both orientations, themeable | _Leverage: Existing legend | Success: Legend displays correctly | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n- [ ] 9. Extract LayerPanel widget\n  - File: `ui/lib/widgets/editor/layer_panel.dart`\n  - Extract layer selection panel\n  - Include add/delete/reorder\n  - Purpose: Layer management UI\n  - _Leverage: Existing layer panel_\n  - _Requirements: 1.1, 3.3_\n  - _Prompt: Implement the task for spec widget-decomposition, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Flutter Developer extracting widgets | Task: Extract LayerPanel to editor/layer_panel.dart | Restrictions: All operations, reorderable | _Leverage: Existing panel | Success: Layer management works | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n- [ ] 10. Extract BindingPanel widget\n  - File: `ui/lib/widgets/editor/binding_panel.dart`\n  - Extract binding configuration form\n  - Split into sub-components if large\n  - Purpose: Binding editing UI\n  - _Leverage: Existing binding form_\n  - _Requirements: 1.1, 1.2_\n  - _Prompt: Implement the task for spec widget-decomposition, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Flutter Developer extracting widgets | Task: Extract BindingPanel to editor/binding_panel.dart | Restrictions: All binding types, validation | _Leverage: Existing form | Success: Binding configuration works | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n## Phase 4: Integration and Cleanup\n\n- [ ] 11. Update EditorPage imports\n  - File: `ui/lib/pages/editor_page.dart`\n  - Replace editor_widgets import with barrel import\n  - Verify all widgets still accessible\n  - Purpose: Use new widget structure\n  - _Leverage: Barrel exports_\n  - _Requirements: 1.3_\n  - _Prompt: Implement the task for spec widget-decomposition, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Flutter Developer updating imports | Task: Update EditorPage to use barrel imports | Restrictions: No functionality change, verify all widgets | _Leverage: Barrel exports | Success: EditorPage works with new imports | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n- [ ] 12. Update other pages with extracted widgets\n  - Files: All pages using editor widgets\n  - Update imports to use common widgets\n  - Remove duplicated widget code\n  - Purpose: Consistent widget usage\n  - _Leverage: Common widgets_\n  - _Requirements: 2.3_\n  - _Prompt: Implement the task for spec widget-decomposition, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Flutter Developer updating imports | Task: Update all pages to use extracted widgets | Restrictions: Use common widgets, remove duplicates | _Leverage: Common widgets | Success: All pages use shared widgets | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n- [ ] 13. Delete editor_widgets.dart\n  - File: `ui/lib/pages/editor_widgets.dart`\n  - Remove after all extractions complete\n  - Verify no remaining references\n  - Purpose: Complete migration\n  - _Leverage: Extraction complete_\n  - _Requirements: 1.1_\n  - _Prompt: Implement the task for spec widget-decomposition, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Flutter Developer cleaning up | Task: Delete editor_widgets.dart after verification | Restrictions: No references remain, all tests pass | _Leverage: Complete extraction | Success: Old file removed, no regressions | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n## Phase 5: Testing\n\n- [ ] 14. Add widget unit tests\n  - Files: `ui/test/widgets/`\n  - Create tests for each extracted widget\n  - Test states and interactions\n  - Purpose: Widget verification\n  - _Leverage: Flutter test framework_\n  - _Requirements: 4.1, 4.2_\n  - _Prompt: Implement the task for spec widget-decomposition, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Flutter Test Developer | Task: Create unit tests for extracted widgets | Restrictions: Test all states, mock dependencies | _Leverage: Flutter testing | Success: High test coverage for widgets | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n- [ ] 15. Add golden tests for visual widgets\n  - Files: `ui/test/widgets/golden/`\n  - Create screenshot tests for key widgets\n  - Test different themes and sizes\n  - Purpose: Visual regression testing\n  - _Leverage: Flutter golden testing_\n  - _Requirements: 4.4_\n  - _Prompt: Implement the task for spec widget-decomposition, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Flutter Test Developer | Task: Create golden tests for visual widgets | Restrictions: Test themes, sizes, states | _Leverage: Golden testing | Success: Visual regressions caught | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n- [ ] 16. Add integration tests for widget interactions\n  - Files: `ui/test/widgets/integration/`\n  - Test widget composition and callbacks\n  - Verify state flows correctly\n  - Purpose: Integration verification\n  - _Leverage: Flutter integration testing_\n  - _Requirements: 4.3_\n  - _Prompt: Implement the task for spec widget-decomposition, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Flutter Test Developer | Task: Create integration tests for widget interactions | Restrictions: Test composition, callbacks, state | _Leverage: Flutter testing | Success: Widget interactions verified | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n",
  "fileStats": {
    "size": 12511,
    "lines": 156,
    "lastModified": "2025-12-03T13:33:10.571Z"
  },
  "comments": []
}