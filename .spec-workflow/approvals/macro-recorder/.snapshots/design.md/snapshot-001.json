{
  "id": "snapshot_1767022117754_7d3hfbmbo",
  "approvalId": "approval_1767022117745_rjvx5sjmy",
  "approvalTitle": "Macro Recorder - Design",
  "version": 1,
  "timestamp": "2025-12-29T15:28:37.754Z",
  "trigger": "initial",
  "status": "pending",
  "content": "# Design Document\n\n## Architecture\n\n```\nUser Keys ‚Üí Daemon Capture ‚Üí Event Buffer ‚Üí UI Editor ‚Üí Rhai Generator ‚Üí Config\n                                                ‚Üì\n                                          Simulator Test\n```\n\n## Components\n\n### 1. Macro Recorder (Rust - keyrx_daemon/src/macro_recorder.rs)\n- Capture key events during recording mode\n- Store events with precise timestamps\n\n### 2. MacroRecorderPage (keyrx_ui/src/pages/MacroRecorderPage.tsx)\n\n**UI Layout:**\n```\n+---------------------------------------------------------------+\n| Macro Recorder                         [‚óè  Recording 00:05]  |\n+---------------------------------------------------------------+\n| [üî¥ Start Recording]  [‚èπÔ∏è Stop]  [‚ñ∂Ô∏è  Test Macro]           |\n+---------------------------------------------------------------+\n| Recorded Events:                                              |\n| 0ms    KEY_H ‚Üì                                    [Edit]      |\n| 50ms   KEY_H ‚Üë                                    [Delete]    |\n| 100ms  KEY_E ‚Üì                                    [Edit]      |\n| 150ms  KEY_E ‚Üë                                    [Delete]    |\n| 200ms  KEY_L ‚Üì                                    [Edit]      |\n| 250ms  KEY_L ‚Üë                                    [Delete]    |\n| 300ms  KEY_L ‚Üì                                    [Edit]      |\n| 350ms  KEY_L ‚Üë                                    [Delete]    |\n| 400ms  KEY_O ‚Üì                                    [Edit]      |\n| 450ms  KEY_O ‚Üë                                    [Delete]    |\n+---------------------------------------------------------------+\n| Generated Rhai Code:                              [Copy]      |\n| macro \"hello_macro\" {                                         |\n|     trigger KEY_F1                                            |\n|     sequence [                                                 |\n|         (KEY_H, Press, 0),                                    |\n|         (KEY_H, Release, 50),                                 |\n|         ...                                                    |\n|     ]                                                          |\n| }                                                              |\n+---------------------------------------------------------------+\n| [Save Macro]                                                  |\n+---------------------------------------------------------------+\n```\n\n### 3. EventTimeline (keyrx_ui/src/components/EventTimeline.tsx)\n- Visual timeline for editing event timing\n- Drag events to adjust timestamps\n\n### 4. generateMacroRhai() (keyrx_ui/src/utils/macroGenerator.ts)\n- Convert recorded events to Rhai macro syntax\n\n## Data Models\n\n```typescript\ninterface MacroEvent {\n  keyCode: string;\n  eventType: 'press' | 'release';\n  timestamp: number;  // Relative to recording start (ms)\n}\n\ninterface Macro {\n  name: string;\n  trigger: string;  // Hotkey that activates macro\n  events: MacroEvent[];\n  description?: string;\n}\n```\n\n## Dependencies\n\n- No new dependencies (use existing React)\n\n## Sources\n\n- [Keyboard Shortcuts design pattern](https://ui-patterns.com/patterns/keyboard-shortcuts)\n- [Macro Recorder](https://www.keysmith.app/)\n",
  "fileStats": {
    "size": 3223,
    "lines": 84,
    "lastModified": "2025-12-29T15:25:57.710Z"
  },
  "comments": []
}