{
  "id": "snapshot_1764771457649_runvd9fcw",
  "approvalId": "approval_1764770440000_qbly19c5z",
  "approvalTitle": "Logging Standardization Tasks (17 tasks)",
  "version": 2,
  "timestamp": "2025-12-03T14:17:37.649Z",
  "trigger": "approved",
  "status": "pending",
  "content": "# Tasks Document\n\n## Phase 1: Infrastructure\n\n- [ ] 1. Create StructuredLogger configuration\n  - File: `core/src/observability/logger.rs`\n  - Configure tracing-subscriber\n  - Support JSON and pretty output\n  - Purpose: Logging configuration\n  - _Leverage: tracing-subscriber_\n  - _Requirements: 1.1, 1.3, 1.4_\n  - _Prompt: Implement the task for spec logging-standardization, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Rust Developer configuring logging | Task: Create StructuredLogger with tracing-subscriber | Restrictions: JSON support, configurable levels | _Leverage: tracing-subscriber | Success: Structured logging configured | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n- [ ] 2. Create LogEntry type\n  - File: `core/src/observability/entry.rs`\n  - Structured log entry with fields\n  - FFI-compatible representation\n  - Purpose: Log data structure\n  - _Leverage: serde_\n  - _Requirements: 1.3_\n  - _Prompt: Implement the task for spec logging-standardization, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Rust Developer creating types | Task: Create LogEntry with FFI representation | Restrictions: Serializable, C-compatible FFI | _Leverage: serde | Success: Log entries structured | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n- [ ] 3. Create LogBridge for FFI\n  - File: `core/src/observability/bridge.rs`\n  - Implement as tracing Layer\n  - Buffer and callback support\n  - Purpose: FFI log bridge\n  - _Leverage: tracing Layer_\n  - _Requirements: 4.1, 4.2_\n  - _Prompt: Implement the task for spec logging-standardization, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Rust Developer creating bridge | Task: Create LogBridge as tracing Layer | Restrictions: Non-blocking, buffered | _Leverage: tracing Layer | Success: Logs bridge to FFI | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n## Phase 2: Macros and Helpers\n\n- [ ] 4. Create logging convenience macros\n  - File: `core/src/observability/macros.rs`\n  - log_event!, log_error!, timed_span!\n  - Purpose: Easy structured logging\n  - _Leverage: tracing macros_\n  - _Requirements: 1.1, 1.3_\n  - _Prompt: Implement the task for spec logging-standardization, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Rust Developer creating macros | Task: Create logging convenience macros | Restrictions: Ergonomic, consistent fields | _Leverage: tracing | Success: Easy to log structured data | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n- [ ] 5. Document logging standards\n  - File: `docs/logging-standards.md`\n  - Define when to use each level\n  - Document required fields\n  - Purpose: Logging guidelines\n  - _Leverage: tracing documentation_\n  - _Requirements: 2.1, 2.2, 2.3, 2.4_\n  - _Prompt: Implement the task for spec logging-standardization, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Technical Writer | Task: Document logging standards and levels | Restrictions: Clear guidelines, examples | _Leverage: tracing docs | Success: Developers know logging standards | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n## Phase 3: Migration\n\n- [ ] 6. Replace println in CLI\n  - Files: `core/src/bin/keyrx.rs`, `core/src/cli/*.rs`\n  - Replace println/eprintln with tracing\n  - Keep user-facing output as println\n  - Purpose: CLI logging migration\n  - _Leverage: Logging macros_\n  - _Requirements: 1.2_\n  - _Prompt: Implement the task for spec logging-standardization, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Rust Developer migrating code | Task: Replace println in CLI with tracing | Restrictions: User output stays println, rest tracing | _Leverage: Logging macros | Success: CLI uses structured logging | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n- [ ] 7. Replace println in engine\n  - Files: `core/src/engine/*.rs`\n  - Replace all debug println with tracing\n  - Add structured fields\n  - Purpose: Engine logging migration\n  - _Leverage: Logging macros_\n  - _Requirements: 1.2_\n  - _Prompt: Implement the task for spec logging-standardization, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Rust Developer migrating code | Task: Replace println in engine with tracing | Restrictions: Structured fields, appropriate levels | _Leverage: Logging macros | Success: Engine uses structured logging | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n- [ ] 8. Replace println in drivers\n  - Files: `core/src/drivers/*.rs`\n  - Replace driver debug output\n  - Add platform-specific context\n  - Purpose: Driver logging migration\n  - _Leverage: Logging macros_\n  - _Requirements: 1.2_\n  - _Prompt: Implement the task for spec logging-standardization, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Rust Developer migrating code | Task: Replace println in drivers with tracing | Restrictions: Platform context, appropriate levels | _Leverage: Logging macros | Success: Drivers use structured logging | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n- [ ] 9. Replace println in FFI\n  - Files: `core/src/ffi/*.rs`\n  - Replace FFI debug output\n  - Never log secrets\n  - Purpose: FFI logging migration\n  - _Leverage: Logging macros_\n  - _Requirements: 1.2_\n  - _Prompt: Implement the task for spec logging-standardization, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Rust Developer migrating code | Task: Replace println in FFI with tracing | Restrictions: No secrets, appropriate levels | _Leverage: Logging macros | Success: FFI uses structured logging | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n- [ ] 10. Replace remaining println calls\n  - Files: All remaining Rust files\n  - Audit for any remaining println\n  - Purpose: Complete migration\n  - _Leverage: grep, logging macros_\n  - _Requirements: 1.2_\n  - _Prompt: Implement the task for spec logging-standardization, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Rust Developer completing migration | Task: Replace all remaining println with tracing | Restrictions: Complete audit, no println remaining | _Leverage: grep | Success: No debug println in codebase | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n## Phase 4: Metrics Bridge\n\n- [ ] 11. Create MetricsBridge\n  - File: `core/src/observability/metrics_bridge.rs`\n  - Connect to MetricsCollector\n  - FFI callback and polling\n  - Purpose: Metrics to FFI\n  - _Leverage: MetricsCollector_\n  - _Requirements: 3.1, 3.4, 4.1_\n  - _Prompt: Implement the task for spec logging-standardization, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Rust Developer creating bridge | Task: Create MetricsBridge for FFI export | Restrictions: Callback and polling, non-blocking | _Leverage: MetricsCollector | Success: Metrics available via FFI | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n- [ ] 12. Create FFI observability exports\n  - File: `core/src/ffi/exports_observability.rs`\n  - Export log and metrics functions\n  - Callback registration\n  - Purpose: FFI interface\n  - _Leverage: LogBridge, MetricsBridge_\n  - _Requirements: 4.1, 4.2, 4.3_\n  - _Prompt: Implement the task for spec logging-standardization, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Rust Developer creating FFI | Task: Create observability FFI exports | Restrictions: Log and metrics, callbacks | _Leverage: Bridges | Success: Flutter can access observability | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n## Phase 5: Flutter Integration\n\n- [ ] 13. Create ObservabilityService\n  - File: `ui/lib/services/observability_service.dart`\n  - Fetch logs and metrics from FFI\n  - Stream updates\n  - Purpose: Flutter observability access\n  - _Leverage: FFI exports_\n  - _Requirements: 4.3, 4.4_\n  - _Prompt: Implement the task for spec logging-standardization, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Flutter Developer creating service | Task: Create ObservabilityService for logs/metrics | Restrictions: Stream updates, efficient polling | _Leverage: FFI exports | Success: Flutter has observability access | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n- [ ] 14. Create LogViewer widget\n  - File: `ui/lib/widgets/debug/log_viewer.dart`\n  - Display logs with filtering\n  - Level and target filters\n  - Purpose: Log visualization\n  - _Leverage: ObservabilityService_\n  - _Requirements: 4.3_\n  - _Prompt: Implement the task for spec logging-standardization, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Flutter Developer creating widget | Task: Create LogViewer widget with filtering | Restrictions: Level filter, search, auto-scroll | _Leverage: ObservabilityService | Success: Logs visible in UI | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n- [ ] 15. Create MetricsWidget\n  - File: `ui/lib/widgets/debug/metrics_widget.dart`\n  - Display key metrics\n  - Real-time updates\n  - Purpose: Metrics visualization\n  - _Leverage: ObservabilityService_\n  - _Requirements: 3.3, 4.3_\n  - _Prompt: Implement the task for spec logging-standardization, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Flutter Developer creating widget | Task: Create MetricsWidget for dashboard | Restrictions: Real-time, key metrics | _Leverage: ObservabilityService | Success: Metrics visible in UI | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n## Phase 6: Testing\n\n- [ ] 16. Add logging tests\n  - File: `core/tests/unit/observability/`\n  - Test log formatting\n  - Test FFI bridge\n  - Purpose: Verify logging\n  - _Leverage: Test fixtures_\n  - _Requirements: Non-functional (reliability)_\n  - _Prompt: Implement the task for spec logging-standardization, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Rust Test Developer | Task: Create logging unit tests | Restrictions: Test formatting, bridge, levels | _Leverage: Test fixtures | Success: Logging verified | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n\n- [ ] 17. Add lint to prevent println\n  - File: `.cargo/config.toml` or clippy.toml\n  - Warn on println in non-CLI code\n  - Purpose: Prevent regression\n  - _Leverage: Clippy lints_\n  - _Requirements: 1.2_\n  - _Prompt: Implement the task for spec logging-standardization, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Rust Developer configuring lints | Task: Add lint to warn on println | Restrictions: Warn in non-CLI, allow in CLI | _Leverage: Clippy | Success: New println causes warning | After completion: Mark task [-] as in-progress before starting, use log-implementation tool to record artifacts, then mark [x] when complete_\n",
  "fileStats": {
    "size": 12391,
    "lines": 164,
    "lastModified": "2025-12-03T14:13:34.686Z"
  },
  "comments": []
}